/* v 2.39
author http://codecanyon.net/user/creativeinteractivemedia/portfolio?ref=creativeinteractivemedia
*/
var FLIPBOOK=FLIPBOOK||{};FLIPBOOK.Book3=function(t,e){this.main=e.main,this.options=e,this.singlePage=e.singlePageMode,this.pageWidth=this.options.pageWidth,this.pageHeight=this.options.pageHeight,this.wrapper="object"==typeof t?t:document.getElementById(t),this.$wrapper=jQuery(this.wrapper).addClass("flipbook-book3");var i=this.wrapper.style;this.singlePage?i.width=String(this.pageWidth)+"px":i.width=String(2*this.pageWidth)+"px",i.height=String(this.pageHeight)+"px",this.$centerContainer=jQuery("<div>").appendTo(this.$wrapper).addClass("flipbook-center-container3"),this.options.singlePageMode&&this.$centerContainer.css({"perspective-origin-x":"0","-webkit-perspective-origin-x":"0"}),this.centerContainerStyle=this.$centerContainer[0].style,this.pagesArr=[],this.animating=!1,this.rightIndex=e.rightToLeft?e.pages.length:0,this.flippedleft=this.rightIndex,this.flippedright=e.pages.length-this.rightIndex,this.numPages=e.pages.length;for(var s,o=0;o<e.pages.length;o++)s=new FLIPBOOK.Page3(this,o,e.pages[o].src,e.pages[o].htmlContent),this.pagesArr.push(s),this.$centerContainer.append(s.$wrapper),this.flippedright++,e.loadAllPages&&s.load();this.pagesArr[0].show()},FLIPBOOK.Book3.prototype={},FLIPBOOK.Book3.prototype.enablePrev=function(t){this.prevEnabled=t},FLIPBOOK.Book3.prototype.enableNext=function(t){this.nextEnabled=t},FLIPBOOK.Book3.prototype.isZoomed=function(){return this.main.zoom>this.options.zoomLevels[0]&&this.main.zoom>1},FLIPBOOK.Book3.prototype.onZoom=function(){if(this.enabled){for(var t=0;t<this.pagesArr.length;t++)this.pagesArr[t].loaded=!1;var e=this;setTimeout(function(){e.updateVisiblePages(!1)},100)}},FLIPBOOK.Book3.prototype.getNumPages=function(){},FLIPBOOK.Book3.prototype.updateBookPosition=function(){var t;t=0==this.rightIndex?"translateX(-"+this.pageWidth/2+"px)":this.rightIndex>=this.options.pages.length?"translateX("+this.pageWidth/2+"px)":"translateX(0)",this.options.singlePageMode&&(t="translateX(0)"),this._setStyle(this.centerContainerStyle,FLIPBOOK.IScroll.utils.style.transform,t)},FLIPBOOK.Book3.prototype.updateVisiblePages=function(t){void 0===t&&(t=!0);for(var e=FLIPBOOK.IScroll.utils.style.transform,i=0;i<this.pagesArr.length;i++)i==this.flippedleft?this.pagesArr[i].show():i!=this.flippedleft-1||this.options.singlePageMode?this.pagesArr[i].hide():this.pagesArr[i].show(),this.pagesArr[i]._setZIndex(0),this.pagesArr[i]._setStyle(this.pagesArr[i].wrapper.style,e,"");this.updateBookPosition(),this.pagesArr[this.rightIndex]&&this.pagesArr[this.rightIndex].load(),this.pagesArr[this.rightIndex+1]&&t&&this.pagesArr[this.rightIndex+1].load(),this.pagesArr[this.rightIndex-1]&&this.pagesArr[this.rightIndex-1].load(),this.options.singlePageMode||(this.pagesArr[this.rightIndex+2]&&t&&this.pagesArr[this.rightIndex+2].load(),this.pagesArr[this.rightIndex-2]&&t&&this.pagesArr[this.rightIndex-2].load(),this.pagesArr[this.rightIndex-3]&&t&&this.pagesArr[this.rightIndex-3].load())},FLIPBOOK.Book3.prototype.enable=function(){this.enabled=!0},FLIPBOOK.Book3.prototype.disable=function(){this.enabled=!1},FLIPBOOK.Book3.prototype.getLeftPage=function(){return this.pagesArr[this.flippedleft-1]},FLIPBOOK.Book3.prototype.getRightPage=function(){return this.pagesArr[this.flippedleft]},FLIPBOOK.Book3.prototype.getLeftBackPage=function(){return this.pagesArr[this.flippedleft-2]},FLIPBOOK.Book3.prototype.getRightBackPage=function(){return this.pagesArr[this.flippedleft+1]},FLIPBOOK.Book3.prototype.getNextPage=function(){return this.pagesArr[this.flippedleft+2]},FLIPBOOK.Book3.prototype.getPrevPage=function(){return this.pagesArr[this.flippedleft-3]},FLIPBOOK.Book3.prototype.nextPage=function(t,e){if(this.nextEnabled){var i=this.options.singlePageMode?this.rightIndex+1:this.rightIndex+2;this.goToPage(i,t)}},FLIPBOOK.Book3.prototype.prevPage=function(t){if(this.prevEnabled){var e=this.options.singlePageMode?this.rightIndex-1:this.rightIndex-2;this.goToPage(e,t)}},FLIPBOOK.Book3.prototype.goToPage=function(t,e){if(!this.flipping)if(t<0&&(t=0),this.options.singlePageMode?t>this.pagesArr.length&&(t=this.pagesArr.length):(t%2!=0&&t--,t>this.pagesArr.length&&(t=this.pagesArr.length)),t!=this.rightIndex){if(e)return this.flippedleft=t,this.flippedright=this.pagesArr.length-t,this.rightIndex=t,this.updateVisiblePages(),void this.options.main.turnPageComplete();this.flipping=!0;void 0===jQuery.easing.easeOutCubic&&this.options.main.initEasing();var i=this;this.goingToPage=t,t>this.rightIndex?(end=180,(i.angle<=0||i.angle>=180||!i.angle)&&(i.angle=1)):t<this.rightIndex&&(end=-180,(i.angle>=0||i.angle<=-180||!i.angle)&&(i.angle=-1));var s=1e3*this.options.pageFlipDuration;s*=Math.abs(end-this.angle)/180,this.options.singlePageMode&&(s/=2),jQuery({someValue:i.angle}).animate({someValue:end},{duration:s,easing:"easeOutCubic",step:function(t){i._setPageAngle(t)},complete:function(){i.rightIndex=t,i.flippedleft=t,i.flippedright=i.pagesArr.length-t,i.updateVisiblePages(),i.angle=0,i.flipping=!1,i.options.main.turnPageComplete()}});try{this.options.main.playFlipSound()}catch(t){}}else this.options.main.turnPageComplete()},FLIPBOOK.Book3.prototype.onSwipe=function(t,e,i,s,o,n,r){if(!this.isZoomed()&&"flipbook-page-link"!=t.target.className&&!jQuery(t.target).parents().hasClass("flipbook-page-htmlContent")&&"start"!=e&&(s=r[0].start.x-r[0].end.x,!this.flipping)){var h=180*s/this.options.main.blw;if("cancel"==e&&n<=1&&(h>0?this.nextPage():h<0&&this.prevPage()),"end"==e&&n<=1&&(h>0?this.nextPage():h<0&&this.prevPage()),"move"==e&&n<=1){if(h>0){if(!this.nextEnabled)return;if(this.options.singlePageMode&&this.rightIndex==this.pagesArr.length-1)return;this.goingToPage=this.options.singlePageMode?this.rightIndex+1:this.rightIndex+2}else if(h<0){if(!this.prevEnabled)return;this.goingToPage=this.options.singlePageMode?this.rightIndex-1:this.rightIndex-2}this.goingToPage!=this.rightIndex&&this.goingToPage>=0&&this.goingToPage<=this.pagesArr.length&&this._setPageAngle(h)}}},FLIPBOOK.Book3.prototype._setStyle=function(t,e,i){t&&(t[e]=i)},FLIPBOOK.Book3.prototype._setPageAngle=function(t){if(this.angle=t,this.options.singlePageMode)t>0?(front=this.pagesArr[this.rightIndex],front._setAngle(t/2),next=this.pagesArr[this.goingToPage],next&&next.show()):(back=this.pagesArr[this.goingToPage],back.show(),back._setAngle(t/2+90));else if(t>0){front=this.pagesArr[this.rightIndex],back=this.pagesArr[this.goingToPage-1],this.applyAngles(front,back,t,90,0),next=this.pagesArr[back.index+1],next&&next.show();e=FLIPBOOK.IScroll.utils.style.transform;0==this.rightIndex&&this._setStyle(this.centerContainerStyle,e,"translateX("+String(-this.options.pageWidth/2+t/180*this.options.pageWidth/2)+"px)"),next||this._setStyle(this.centerContainerStyle,e,"translateX("+String(t/180*this.options.pageWidth/2)+"px)")}else{back=this.pagesArr[this.rightIndex-1],front=this.pagesArr[this.goingToPage],this.applyAngles(front,back,t,-90,180),prev=this.pagesArr[this.goingToPage-1],prev&&prev.show();var e=FLIPBOOK.IScroll.utils.style.transform;this.rightIndex==this.pagesArr.length&&this._setStyle(this.centerContainerStyle,e,"translateX("+String(this.options.pageWidth/2+t/180*this.options.pageWidth/2)+"px)"),prev||this._setStyle(this.centerContainerStyle,e,"translateX("+String(t/180*this.options.pageWidth/2)+"px)")}},FLIPBOOK.Book3.prototype.applyAngles=function(t,e,i,s,o){i<s?(t&&(t._setAngle(i+o),t.show()),e&&e.hide()):(e&&(e._setAngle(i+o),e.show()),t&&t.hide())},FLIPBOOK.Page3=function(t,e,i,s){this.book=t,this.options=t.options,this.texture=i,this.html=s,this.index=e,this.$wrapper=jQuery("<div>").addClass("flipbook-page3").width(t.options.pageWidth).height(t.options.pageHeight),this.wrapper=this.$wrapper[0],this.$img=jQuery("<img>").appendTo(this.$wrapper),this.$canvas=jQuery("<div>").appendTo(this.$wrapper).addClass("flipbook-page3-html"),this.hidden=!1,this.hide(),this.zIndex=0,this.options.singlePageMode?(this.$wrapper.addClass("flipbook-page3-front"),this.type="front"):e%2==0?(this.$wrapper.css("left",String(this.book.options.pageWidth)+"px").addClass("flipbook-page3-front"),this.type="front"):(this.$wrapper.addClass("flipbook-page3-back"),this.type="back"),"doubleWithCover"==this.options.pageMode&&(e%2==0&&e>0?this.$img.css({transform:"scaleX(2)","-webkit-transform":"scaleX(2)","transform-origin":"100%","-webkit-transform-origin":"100%"}):e%2==1&&e<this.book.numPages-1&&this.$img.css({transform:"scaleX(2)","-webkit-transform":"scaleX(2)","transform-origin":"0","-webkit-transform-origin":"0"}))},FLIPBOOK.Page3.prototype={load:function(){function t(t,i,s){e.$canvas.empty(),jQuery(t).appendTo(e.$canvas),jQuery(i).appendTo(e.$canvas),delete t}if(1!=this.loaded){this.loaded=!0;var e=this,i=this.book.main;if(e.options.pdfMode){var s=e.options.rightToLeft?this.book.pagesArr.length-this.index-1:this.index;i.loadPagesFromPdf([s]),jQuery(i).bind("pageLoaded",function(i,o){o==s&&(c=e.options.pages[s].canvas[e.options.pageTextureSize],h=e.options.pages[s].htmlContent,t(c,h,e.options.rightToLeft))})}else this.$img.attr("src",this.texture),this.$img[0].onload=function(){e.$wrapper.css({background:"none"}),i.setLoadingProgress(1)},e.html&&jQuery(e.html).appendTo(e.$canvas)}},show:function(){this.hidden&&(this.$wrapper[0].style.display="block"),this.hidden=!1},hide:function(){this.hidden||(this.$wrapper[0].style.display="none"),this.hidden=!0},_setScale:function(t){if(this.scale!=t){var e=FLIPBOOK.IScroll.utils.style.transform,i="scaleX("+String(t)+")";this.scale=t,this._setStyle(e,i)}},_setAngle:function(t){if(this.angle!=t){this.angle=t;var e,i=FLIPBOOK.IScroll.utils.style.transform;"3d"==this.book.options.viewMode?e="front"==this.type?"rotateY("+String(-t)+"deg)":"rotateY("+String(180-t)+"deg)":"2d"==this.book.options.viewMode&&("front"==this.type?(t>90&&(t=90),e="scaleX("+String((180-2*t)/180)+")"):(t<90&&(t=90),e="scaleX("+String(2*t/180-1)+")")),this._setStyle(this.wrapper.style,i,e);var s,o=0;for(s=0;s<this.book.pagesArr.length;s++)s!=this.index&&this.book.pagesArr[s].zIndex>o&&(o=this.book.pagesArr[s].zIndex);this._setZIndex(o+1)}},_setZIndex:function(t){this.zIndex!=t&&(this.wrapper.style["z-index"]=t),this.zIndex=t},_setStyle:function(t,e,i){t&&(t[e]=i)}};